---
title: 'cm006: `dplyr` Exercise'
output: html_notebook
editor_options: 
  chunk_output_type: inline
---
<!---The following chunk allows errors when knitting--->

```{r allow errors, echo = FALSE}
knitr::opts_chunk$set(error = TRUE)
```

```{r load packages for initial knit, warning = FALSE, include = F}
```

**Optional, but recommended startup**:

Change the file output to both html and md _documents_ (not notebook).

# Intro to `dplyr` syntax

1. Load the `gapminder` and `tidyverse` packages. Hint: `suppressPackageStartupMessages()`!
    - This loads `dplyr`, too.
    
```{r load packages, warning = F, message = F}
# load your packages here:
library(FILL_THIS_IN)
library(FILL_THIS_IN)
```
    
2. `knit` the document. 

## `select()` (8 min)

1. Make a data frame containing the columns `year`, `lifeExp`, `country` from the gapminder data, in that order.

```{r}
select(gapminder, FILL_THIS_IN)
```


2. Select all variables, from `country` to `lifeExp`.

```{r}
# This will work:
select(gapminder, FILL_THIS_IN, FILL_THIS_IN, FILL_THIS_IN, FILL_THIS_IN)

# Better way:

```


3. Select all variables, except `lifeExp`.

```{r}
select(gapminder, FILL_THIS_IN)
```

4. Put `continent` first. Hint: use the `everything()` function.

```{r}
select(gapminder, FILL_THIS_IN, FILL_THIS_IN)
```


5. Rename `continent` to `cont`.

```{r}
rename(gapminder, FILL_THIS_IN)
```


## `arrange()` (8 min)

1. Order by year.

```{r}
arrange(gapminder, FILL_THIS_IN)
```

2. Order by year, in descending order.

```{r}
arrange(gapminder, FILL_THIS_IN)
```

3. Order by year, then by life expectancy.

```{r}
arrange(gapminder, FILL_THIS_IN, FILL_THIS_IN)
```

## Piping, `%>%` (8 min)

Note: think of `%>%` as the word "then"!

1. Combine `select()` Task 1 with `arrange()` Task 3.

```{r}
# Nesting function calls is hard to read

# Pipe operators allow us to read operations line by line
# Here the gapminder is the input for the first argument of the next function

```

## `filter()` (8 min)

1. Only take data with population greater than 100 million.

```{r}
gapminder %>%
  filter(FILL_THIS_IN > 100000000)
```

2. Of those, only take data from Asia.

```{r}

```

## git stuff (Optional)

Knit, commit, push!

# Bonus Exercises

If there's time remaining, we'll practice with these three exercises. I'll give you 1 minute for each, then we'll go over the answer.

1. Take all countries in Europe that have a GDP per capita greater than 10000, and select all variables except `gdpPercap`. (Hint: use `-`).

2. Take the first three columns, and extract the names.

3. Of the `iris` data frame, take all columns that start with the word "Petal". 
    - Hint: take a look at the "Select helpers" documentation by running the following code: `?tidyselect::select_helpers`.
    - Exercise from [r-exercises](https://www.r-exercises.com/2017/10/19/dplyr-basic-functions-exercises/).
